{% extends 'base.html' %}
{% load static %}

{% block content %}
<h4>Book: {{ car.name }}</h4>
<form method="post" action="{% url 'create_trip' %}" id="trip-form">
  {% csrf_token %}
  <input type="hidden" name="car_id" value="{{ car.id }}">

  <label for="origin-input">Origin</label><br>
  <input id="origin-input" name="origin_address" type="text" placeholder="Start location" required style="width:100%; max-width:600px;"><br>

  <label for="destination-input">Destination</label><br>
  <input id="destination-input" name="destination_address" type="text" placeholder="Where to?" required style="width:100%; max-width:600px;"><br><br>

  <label for="driver-select">Choose driver (optional)</label><br>
  <select name="driver_id" id="driver-select">
    <option value="">— choose driver —</option>
    {% for d in drivers %}
      <option value="{{ d.id }}">{{ d.name }}</option>
    {% endfor %}
  </select>

  <!-- hidden lat/lng and route data (filled by JS) -->
  <input type="hidden" id="origin-lat" name="origin_lat">
  <input type="hidden" id="origin-lng" name="origin_lng">
  <input type="hidden" id="destination-lat" name="destination_lat">
  <input type="hidden" id="destination-lng" name="destination_lng">
  <input type="hidden" id="route-polyline" name="route_polyline">
  <input type="hidden" id="distance-text" name="distance_text">
  <input type="hidden" id="duration-text" name="duration_text">

  <button type="button" id="get-route" class="btn btn-danger">Show route</button>
  <button type="submit" class="btn btn-danger">Confirm booking</button>
</form>

<hr>
<div id="map" style="width:50%; height:480px; max-width:900px;"></div>

<!-- 1. Load our map.js (defines window.initMap) -->
<script defer src="{% static 'js/map.js' %}" data-google-maps-api-key="{{ google_maps_api_key }}"></script>
{% endblock %}
